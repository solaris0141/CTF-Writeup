UTAR (University Tunku Abdul Rahman) CTF 2024 
=====

Unfortunately, there were only 1 crypto challenge so I will just write my solving process of it. Most of the challenges are forensics so I won't be writing about it.

---

## crypto/CryptoQuest
#### *source.py*
```python
from Crypto.Util.number import getPrime, isPrime, bytes_to_long
from Crypto.Util.Padding import pad
import os


FLAG = b"UTAR{--REDACTED--}UTAR{--REDACTED--}.."


def getPrimes(coefficient):
    while True:
        a = getPrime(512)
        p = 3 * coefficient * a + 2
        if isPrime(p):
            break
    while True:
        b = getPrime(512)
        q = 3 * coefficient * b + 2
        if isPrime(q):
            break
    return p, q


def encrypt(message, coefficient):
    p, q = getPrimes(coefficient)
    n = p * q

    padded_message = bytes_to_long(pad(message, 256))
    message = bytes_to_long(message)

    c1 = (message * (message + coefficient)) % n
    c2 = (padded_message * (padded_message + coefficient)) % n
    return (n, c1, c2)


def main():
    coefficient = getPrime(128)
    out = ""

    message = FLAG[0:len(FLAG)//2]
    n1, c1, c2 = encrypt(message, coefficient)
    out += f"{n1=}\n{c1=}\n{c2=}\n"

    message = FLAG[len(FLAG)//2:]
    n2, c3, c4 = encrypt(message, coefficient)
    out += f"{n2=}\n{c3=}\n{c4=}\n"

    out += f"{len(FLAG)}"

    with open("out.txt", "w") as f:
        f.write(out)
        



if __name__ == '__main__':
    main()
```

#### output.txt
```txt
93768948782729745478599497793422837990844683777054239378160474776560328573740431328119069546474726108930506737169994788955100441012384360021152667154287992695010195576758316949585621551596158372376345419456965488254521532147792713935363300735987030988082563979975500168572577260733535458985853917764527363407769270888828243816895641732445160252301964925541012207546553786760547571437309
3621040439219007434888695593528949492599239288972667623035553668240449325367907807190984382
38961170119626522687626510695512763945837282490901105292914551271909132862880451294564581486215394942213278613219193998476780825416310064483441834455024759682451365186271467161856917087605946914135889892673345642528730827437281612146749527084617454349049733455068960554905116871841706314477013111977569678325423376811306656890003048738805309787387561294793597356241924105500206801243681
91025568464739694140466003159234293768290991283984557403047262623528591078227010433420470804003649933884386662079743329798798525248580861464365943451120270370457258649269769883650838118032727366611574875678349888523527808307940817294050887454976727571614338539148795127773589683011325602555167585577233867721677509481441225602003683137182844508449837448007714031771752450966624270918589
1407336180112944499971322497698050797074666521478341254597057144222846308346063835176567810
66733679878633667124757259223269231432367881207935206058792943692988714505334832943381814065625916206697088774218098846411737964259410579281236726564745615128051703728622261928271407714135067615429579405549983711303762437418267153754333494140843478524850272910127575235376097155240248320583861866005852543936467306384094561646405485745134325827256105810397144185548281681262004671878944
38
```
